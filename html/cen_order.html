
<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no" />
    <meta content="black" name=" apple-mobile-web-app-capable" />
    <title>个人中心-我的订单</title>
    <meta name="keywords" content="关键词">
    <meta name="description" content="网站描述">
    <link href="../css/api.css" rel="stylesheet" />
    <link href="../css/common.css" rel="stylesheet" />
    <link href="../css/style.css" rel="stylesheet" />
    <link rel="stylesheet" href="../css/swiper.css">
    <link href="../css/city-picker.css" rel="stylesheet" type="text/css" />

</head>

<body>
    <!--头部-->
    <header>
        <div class="in_top">
            <div class="top_left">
                <a href="javascript:;" class="reSP">
                    <span></span>
                </a>
            </div>
            <div class="top_con">
                <h2>我的订单</h2>
            </div>

        </div>
    </header>
    <!--头部End-->
    <!--内容-->
    <div class="container" id="root">
        <div class="tit_CO ">
            <ul class="MY_orderULtop" style="width:28.5rem">
                <li><a href="javascript:;" :class="status == 0 ? 'active' : ''" @click="switchStatus(0)">所有订单</a></li>
                <li><a href="javascript:;" :class="status == 1 ? 'active' : ''" @click="switchStatus(1)">未接单</a></li>
                <li><a href="javascript:;" :class="status == 2 ? 'active' : ''" @click="switchStatus(2)">已接单</a></li>
                <li><a href="javascript:;" :class="status == 3 ? 'active' : ''" @click="switchStatus(3)">已拒单</a></li>
                <li><a href="javascript:;" :class="status == 4 ? 'active' : ''" @click="switchStatus(4)">已支付</a></li>
                <li><a href="javascript:;" :class="status == 7 ? 'active' : ''" @click="switchStatus(7)">已发货</a></li>
                <li><a href="javascript:;" :class="status == 8 ? 'active' : ''" @click="switchStatus(8)">已到达</a></li>
                <li><a href="javascript:;" :class="status == 10 ? 'active' : ''" @click="switchStatus(10)">订单完成</a></li>
            </ul>
        </div>

        <div class="list_CO con add_adfix2">
            <ul>
                <li v-for="(item,index) of orderList" @click="toDeta(item.order_id)">
                    <div class="date">
                        <span class="span1">{{item.year}}</span>
                        <span class="span2">{{item.month}}月</span>
                    </div>
                    <div class="main">
                        <h2>订单编号：{{item.order_id}}
                          <a v-if="item.status == 1">未接单</a>
                          <a v-if="item.status == 2">已接单</a>
                          <!-- <a v-if="item.status == 3">拒单或者终止订单</a> -->
                          <a v-if="item.status == 3">终止订单</a>
                          <a v-if="item.status == 4">已支付</a>
                          <!-- <a v-if="item.status == 5">安排车辆</a>
                          <a v-if="item.status == 6">确认接货</a> -->
                          <a v-if="item.status == 7">已发货</a>
                          <a v-if="item.status == 8">已到达或者等待签收</a>
                          <!-- <a v-if="item.status == 9">等待支付尾款</a> -->
                          <a v-if="item.status == 10">订单完成</a>

                        </h2>
                        <a href="javascript:;" class="DDSJ_deta">
                            <h3><span class="span1"><em>始</em>{{item.start_province_name}}</span><span class="span2"><em>终</em>{{item.end_province_name}}</span></h3>
                            <h4><span class="span1">{{item.origin_city_name}}</span><span class="span2">{{item.end_city_name}}</span></h4>
                        </a>
                        <h5>
                            <!-- <span>纸箱</span> -->
                            <span>{{item.order_nums}}件</span>
                            <span>¥{{item.all_money}}</span>
                            <span>{{item.order_kgs}}吨</span>
                        </h5>
                    </div>
                </li>

                <!-- <li>
                    <div class="date">
                        <span class="span1">16</span>
                        <span class="span2">6月</span>
                    </div>
                    <div class="main">
                        <h2>订单编号：56145646156<a>待支付</a></h2>
                        <a href="javascript:;" class="DZF_deta">
                            <h3><span class="span1"><em>始</em>上海</span><span class="span2"><em>终</em>深圳</span></h3>
                            <h4><span class="span1">上海市</span><span class="span2">盐田市</span></h4>
                        </a>
                        <h5>
                            <span>纸箱</span>
                            <span>50件</span>
                            <span>¥15000/吨</span>
                            <span>10吨</span>
                        </h5>
                        <h6><a href="javascript:;" class="payment">去支付</a></h6>
                    </div>
                </li>

                <li>
                    <div class="date">
                        <span class="span1">16</span>
                        <span class="span2">6月</span>
                    </div>
                    <div class="main">
                        <h2>订单编号：56145646156<a>待收货</a></h2>
                        <a href="javascript:;" class="DSH_deta">
                            <h3><span class="span1"><em>始</em>上海</span><span class="span2"><em>终</em>深圳</span></h3>
                            <h4><span class="span1">上海市</span><span class="span2">盐田市</span></h4>
                        </a>
                        <h5>
                            <span>纸箱</span>
                            <span>50件</span>
                            <span>¥15000/吨</span>
                            <span>10吨</span>
                        </h5>
                        <h6><a href="javascript:;" class="query_2">物流查询</a></h6>
                    </div>
                </li>

                <li>
                    <div class="date">
                        <span class="span1">16</span>
                        <span class="span2">6月</span>
                    </div>
                    <div class="main">
                        <h2>订单编号：56145646156<a>已完成</a></h2>
                        <a href="javascript:;" class="YWC_deta">
                            <h3><span class="span1"><em>始</em>上海</span><span class="span2"><em>终</em>深圳</span></h3>
                            <h4><span class="span1">上海市</span><span class="span2">盐田市</span></h4>
                        </a>
                        <h5>
                            <span>纸箱</span>
                            <span>50件</span>
                            <span>¥15000/吨</span>
                            <span>10吨</span>
                        </h5>
                        <h6>
                            <a href="javascript:;" class="ypj">已评价</a>
                            <a href="javascript:;" class="censhA">申请售后</a>
                            <a href="javascript:;" class="query_2">物流查询</a>
                        </h6>
                    </div>
                </li>

                <li>
                    <div class="date">
                        <span class="span1">16</span>
                        <span class="span2">6月</span>
                    </div>
                    <div class="main">
                        <h2>订单编号：56145646156<a>售后中</a></h2>
                        <a href="javascript:;" class="SHZ_deta">
                            <h3><span class="span1"><em>始</em>上海</span><span class="span2"><em>终</em>深圳</span></h3>
                            <h4><span class="span1">上海市</span><span class="span2">盐田市</span></h4>
                        </a>
                        <h5>
                            <span>纸箱</span>
                            <span>50件</span>
                            <span>¥15000/吨</span>
                            <span>10吨</span>
                        </h5>
                    </div>
                </li> -->
            </ul>
        </div>
    </div>
    <!--内容End-->
    <script src="../script/api.js"></script>
    <script src="../script/swiper.js"></script>
    <script src="../script/app.js"></script>
    <script src="../script/jquery.js"></script>
    <script src="../script/public.js"></script>
    <script src="../script/vue.js"></script>

    <script>
        apiready = function() {
            api.parseTapmode();
            var header = $api.dom('header'); // 获取 header 标签元素
            var footer = $api.dom('footer'); // 获取 footer 标签元素
            var section = $api.dom('.container');
            var sectionH = $api.fixStatusBar(section);
            var headerH = $api.fixStatusBar(header);
            //最新api.js为了适配iPhoneX增加的方法，修复底部Footer部分与iPhoneX的底部虚拟横条键重叠的问题；
            var footerH = $api.fixTabBar(footer);

            var vm = new Vue({
                el: '#root',
                data: {
                    orderList: [],
                    status: ''
                },
                methods: {
                    //跳转到订单详情页面
                    toDeta:function(orderId){
                      api.openWin({
                          name: 'cen_deta',
                          url: './cen_deta.html',
                          pageParam: {
                              orderId: orderId
                          }
                      });

                    },
                    //切换订单状态
                    switchStatus: function(status) {
                        if (status != this.status) {
                            this.status = status
                            this.getOrderList();
                        } else {
                            return;
                        }
                    },
                    //获取订单列表
                    getOrderList: function() {
                        var appToken = $api.getStorage('appToken');
                        var url = HOST + '/api/user/getOrderList';
                        var status = this.status;
                        if(status == 0){
                          status == ''
                        }
                        var _this = this;
                        api.showProgress();
                        api.ajax({
                            url: url,
                            method: 'post',
                            headers: {
                                'X-Requested-With': 'XMLHttpRequest'
                            },
                            data: {
                                values: {
                                    appToken: appToken,
                                    status: status
                                }
                            }
                        }, function(ret) {
                            api.hideProgress();
                            if (ret.code == 1) {
                                var orderlist = ret.data.data;
                                for (var i = 0; i < orderlist.length; i++) {
                                    var time = new Date((orderlist[i].add_time) * 1000);
                                    var y = time.getFullYear();
                                    var m = time.getMonth() + 1;
                                    orderlist[i].year = y;
                                    orderlist[i].month = m;
                                }
                                _this.orderList = orderlist;
                            } else {
                                alert(ret.msg);
                                api.closeWin();
                                api.openWin({
                                    name: 'sign',
                                    url: './sign.html'
                                });

                            }
                        });

                    }
                },
                created: function() {
                    this.getOrderList();
                }
            })




            // var arr_link = ['cen_order','cenddsj_order','cendzf_order','cendsh_order','cenpj_order','censh_order'];
            // $('.MY_orderULtop li').bind('click',function() {
            //   arr_linkfun(arr_link[$(this).index()]);
            // })
            //
            //
            // function arr_linkfun(name) {
            //   api.openWin({
            //       name: name,
            //       url: name+'.html',
            //       pageParam: {
            //           name: 'test'
            //       },
            //       bounces: false,
            //       animation:{
            //           type:"none",                //动画类型（详见动画类型常量）
            //           subType:"from_right",       //动画子类型（详见动画子类型常量）
            //           duration:300                //动画过渡时间，默认300毫秒
            //       }
            //   });
            // }
            api.addEventListener({
                name: 'keyback'
            }, function(ret, err) {
                if (ret) {
                    api.closeWin({
                        name: 'cen_order'
                    });
                }
            });
            api.addEventListener({
                name: 'renovateOrder'
            }, function(ret, err){
                if( ret ){
                     vm.getOrderList();
                }
            });

            $('.reSP').bind('click', function() {
                api.closeWin({
                    name: 'cen_order'
                });
            });


            $('.DDSJ_deta').bind('click', function() {
                api.openWin({
                    name: 'cenddsj_deta',
                    url: 'cenddsj_deta.html',
                    pageParam: {
                        name: 'test'
                    },

                    bounces: false
                });
            });

            $('.DZF_deta').bind('click', function() {
                api.openWin({
                    name: 'cendzf_deta',
                    url: 'cendzf_deta.html',
                    pageParam: {
                        name: 'test'
                    },

                    bounces: false
                });
            });

            $('.DSH_deta').bind('click', function() {
                api.openWin({
                    name: 'cendsh_deta',
                    url: 'cendsh_deta.html',
                    pageParam: {
                        name: 'test'
                    },

                    bounces: false
                });
            });

            $('.YWC_deta').bind('click', function() {
                api.openWin({
                    name: 'cendywc_deta',
                    url: 'cendywc_deta.html',
                    pageParam: {
                        name: 'test'
                    },

                    bounces: false
                });
            });

            $('.DPJ_deta').bind('click', function() {
                api.openWin({
                    name: 'cenpj_deta',
                    url: 'cenpj_deta.html',
                    pageParam: {
                        name: 'test'
                    },

                    bounces: false
                });
            });

            $('.payment').bind('click', function() {
                api.openWin({
                    name: 'payment',
                    url: 'payment.html',
                    pageParam: {
                        name: 'test'
                    },

                    bounces: false
                });
            });

            $('.query_2').bind('click', function() {
                api.openWin({
                    name: 'query_2',
                    url: 'query_2.html',
                    pageParam: {
                        name: 'test'
                    },

                    bounces: false
                });
            });

            $('.censhA').bind('click', function() {
                api.openWin({
                    name: 'censh_deta',
                    url: 'censh_deta.html',
                    pageParam: {
                        name: 'test'
                    },

                    bounces: false
                });
            });



        }
    </script>


</body>

</html>
